## 1. 哈希指针

`哈希指针` 本质上就是一个哈希，指针只是一种形象的说法。下面从源码中看一下 Block header 的结构（src/primitives/block.h）：

```cpp
/** Nodes collect new transactions into a block, hash them into a hash tree,
 * and scan through nonce values to make the block's hash satisfy proof-of-work
 * requirements.  When they solve the proof-of-work, they broadcast the block
 * to everyone and the block is added to the block chain.  The first transaction
 * in the block is a special one that creates a new coin owned by the creator
 * of the block.
 */
class CBlockHeader
{
public:
    // header
    int32_t nVersion;
    uint256 hashPrevBlock;
    uint256 hashMerkleRoot;
    uint32_t nTime;
    uint32_t nBits;
    uint32_t nNonce;
```

由源码可知，只有一个 `hashPrevBlock` 的哈希值，而没有所谓的指针。那如何根据这个 `hashPrevBlock` 找到对应的区块呢？

全节点一般会将所有的区块数据保存在一个 `(key, value)` 的数据库里，其中 `key` 就是区块的哈希， `value` 就是区块的内容，常用的 `(key, value)` 数据库是 [levelDB](https://github.com/google/leveldb) 。

## 2. 区块恋

意思是一对情侣用同一个账户买入比特币，然后将私钥从中间截断，没人保留其中的一半，如果最后分手了，那么当初买的币就会被永久的锁在区块链上。

这样做有这么几个问题：

1. 如果其中一人把私钥丢了，那么比特币就取不出来了
2. 这样截断私钥的做法会降低私钥的安全性。在比特币系统中，私钥的安全性与其长度密切相关。原本私钥是 256 位，现在截断成两份，各 128 位，那么通过已拥有的 128 位私钥来暴力破解剩余的 128 位就变得容易得多。
   对于这种多个人共享账户的情况，不要用截断私钥的方式，而要用 `多重签名（MULTISIG）` 。

## 3. 分布式共识

主要讨论一个问题：为什么比特币系统能够绕过分布式共识中的那些不可能结论？

严格意义上来说，比特币并没有取得真正意义上的共识，因为取得的共识随时都有可能被推翻。比如，一般认为一个区块后面有 6 个后继区块时，才认为这个区块是不可篡改（推翻）的，而对于最新产生的区块，是有可能被推翻的。

再就是，也说明理论与实践会有一些差别，在实践中，可能通过修改一下理论模型，或者借助其他手段，就可以化不可能为可能。

## 4. 比特币的稀缺性

要想吸引矿工来挖矿，要么增加预期收益，要么减少预期开销。发行新的虚拟货币时，都有一个冷启动的问题，怎么吸引大家来挖矿，最主要的做法就是给早期的矿工更多的收益。

那比特币是怎样克服冷启动的呢？主要有两点，一是早期挖矿的难度比较低，二是早期的比特币出块奖励比较高。

但也是由于比特币的稀缺性，其实它是不适合作为货币的。

## 5. 量子计算

很多人有这样的担心，当量子计算发展起来以后，由于加密货币都是建立在密码学的基础之上，到时候加密货币是不是就不安全了？因为传说中的量子计算机是非常强大的，可以破解各种现有的加密算法。

总的来说，这种担心是不必要的，首先，量子计算技术离使用还有很长一段距离，而且，如果真有一天，量子计算可以破解现有的加密技术的话，那么首先冲击的是现有的传统金融业，比如网上银行、网上转账等，都会变得不安全了，因为与传统金融业相比，加密货币所占有的总市值只是很小的一部分，要攻击肯定也是先攻击传统金融这些更有钱的机构。而且将来也还会有量子加密算法。

另外，比特币中并没有把账户的公钥直接暴露出来，而是通过公钥取 `hash` 之后得到一个地址。如果之后，量子计算真的可以从公钥反推出私钥的话，那么，其实比特币还有一层保护，上面提到，一般暴露的是公钥 `hash` 之后的地址， `hash` 之后会丢失信息，所以从 `hash` 之后的地址推导出公钥是几乎不可能的，即使是量子计算也不行。

---

个人疑问

在一个交易中，需要通过公钥来验证签名，所以需要提供公钥，这样不就直接暴露公钥了吗？

答：确实会暴露公钥，所以一个地址取完钱之后就不安全了，应该再换一个新的公私钥对以及地址。

---

这里重点是区别加密与取哈希，加密是需要保证完整性的，这样才能保证未来可以解密成功。而取哈希不需要保证完整性，并且不保证完整性才是比较好的，只要不会频繁的发生哈希碰撞即可。
