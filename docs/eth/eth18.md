以太坊将区块时间降低到了10几秒的，这大幅提高了交易的效率，但是也带来了一些问题，最主要的问题就是临时性的分叉会变成常态，分叉的数目也会更多。

如果以太坊沿用比特币的共识机制，也就是最长链是合法链，挖出的其他区块都作废，那么就可能造成一个很严重的问题，就是 **挖矿的中心化** 。这里简述一下，假设一个矿池具有全网 30% 的算力，那么它一旦挖出一个区块，那么这个区块所在的链就有很大的概率变成最长合法链。因为这个矿池肯定会沿着自己发布的区块向后挖，而如果其他的矿工/矿池不沿着这个区块向后挖，很可能就会做无用功，受到该激励的影响，他们也会沿着这条链向后挖，从而导致算力的集中化。

## GHOST

以太坊使用基于 `GHOST` 的协议来解决这个问题。这个协议的核心思想是矿工挖出的区块作废后，也可以相应地得到一些奖励。

### 简述

下面先简要说明一下该协议。

![base protocol](~@/images/eth/eth18/base_protocol.png)

最新的区块可以选择包含叔父区块，这样叔父区块就可以得到相应的一些奖励，同时，包含叔父区块的最新区块也可以得到一些奖励。

这样设计的好处是鼓励系统发生分叉后及时进行合并。

### 完整的 GHOST 协议

![all protocol](~@/images/eth/eth18/all_protocol.png)

`叔父区块` 是指跟当前最新区块在七代以内有共同的祖先的区块，换句话说，合法的叔父区块最多只有六代。

设计成七代以内的好处有：

- 减少全节点需要记录的区块数目，如果允许的过多，那么全节点就需要验证并存储这些区块。
- 鼓励分叉的区块尽可能早的进行合并，因为叔父区块的奖励是递减的，尽可能早的在最长合法链上挖矿，就有可能挖出新区块，从而可以包含自己之前挖出的叔父区块。

对于包含叔父区块的当前区块来说，无论包含的是哪一代的叔父区块，获得的奖励都是 1 / 32 。

在以太坊中，矿工挖矿成功得到奖励包括两部分：1）固定的区块奖励：block reward；2）交易手续费：gas fee

对于叔父区块来说，只能得到固定的区块奖励，交易手续费是得不到的。并且，节点在检查叔父区块的合法性时，只会判断该区块是否满足工作量证明，而不会去判断其内部的交易是否合法。
